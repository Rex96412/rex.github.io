<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>æŠ•ç¥¨çµæœ</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f0f4ff;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
        padding: 20px;
        margin: 0;
    }

    .container {
        background: white;
        padding: 25px 40px;
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
        max-width: 500px;
        width: 100%;
        text-align: center;
    }

    h2 {
        margin-bottom: 20px;
    }

    #voteCounts {
        margin-bottom: 20px;
        font-size: 18px;
    }

    #voteCounts p {
        margin: 8px 0;
    }

    /* Chartå®¹å™¨é™åˆ¶å¤§å° */
    #chartContainer {
        width: 100%;
        max-width: 500px;  /* æœ€å¤§å¯¬åº¦ */
        height: 300px;     /* å›ºå®šé«˜åº¦ */
        margin: 0 auto 20px;
    }

    button {
        margin-top: 10px;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        background-color: #4e7cff;
        color: white;
    }

    button:hover {
        background-color: #3461c9;
    }

    .btn-secondary {
        background-color: #95a5a6;
        margin-left: 10px;
    }

    .btn-secondary:hover {
        background-color: #7f8c8d;
    }
</style>
</head>
<body>

<div class="container">
    <h2>æŠ•ç¥¨çµæœ</h2>
    <p id="student"></p>
    <p id="personalVote"></p>

    <div id="voteCounts">
        <p>éŸ“åœ‹ç‘œç¥¨æ•¸ï¼š<span id="countA">0</span></p>
        <p>è”¡è‹±æ–‡ç¥¨æ•¸ï¼š<span id="countB">0</span></p>
        <p>å®‹æ¥šç‘œç¥¨æ•¸ï¼š<span id="countC">0</span></p>
    </div>

    <div id="chartContainer">
        <canvas id="voteChart"></canvas>
    </div>

    <button onclick="location.href='vote.html'">â¬… å›æŠ•ç¥¨é </button>
    <button class="btn-secondary" onclick="location.href='index.html'">ğŸ  å›ç™»å…¥é </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // æª¢æŸ¥æ˜¯å¦ç™»å…¥
    const studentID = localStorage.getItem("studentID");
    if (!studentID) {
        alert("è«‹å…ˆç™»å…¥ï¼");
        window.location.href = "index.html";
    } else {
        document.getElementById("student").innerText = "å­¸è™Ÿï¼š" + studentID;
    }

    // é¡¯ç¤ºå€‹äººæŠ•ç¥¨çµæœ
    const personalVote = localStorage.getItem("voted_"+studentID);
    if (personalVote === "A") {
        document.getElementById("personalVote").innerText = "ä½ æŠ•çµ¦ï¼šéŸ“åœ‹ç‘œ";
    } else if (personalVote === "B") {
        document.getElementById("personalVote").innerText = "ä½ æŠ•çµ¦ï¼šè”¡è‹±æ–‡";
    } else if (personalVote === "C") {
        document.getElementById("personalVote").innerText = "ä½ æŠ•çµ¦ï¼šå®‹æ¥šç‘œ";
    } else {
        document.getElementById("personalVote").innerText = "ä½ å°šæœªæŠ•ç¥¨";
    }

    // è®€ç¥¨æ•¸
    const countA = parseInt(localStorage.getItem("countA") || 0);
    const countB = parseInt(localStorage.getItem("countB") || 0);
    const countC = parseInt(localStorage.getItem("countC") || 0);

    // æ›´æ–°æ•¸å­—
    document.getElementById("countA").innerText = countA;
    document.getElementById("countB").innerText = countB;
    document.getElementById("countC").innerText = countC;

    // ç•« Chart.js é•·æ¢åœ–
        const ctx = document.getElementById('voteChart').getContext('2d');
    const voteChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['éŸ“åœ‹ç‘œ','è”¡è‹±æ–‡','å®‹æ¥šç‘œ'],
            datasets: [{
                label: 'ç¥¨æ•¸',
                data: [countA, countB, countC],
                backgroundColor: ['#3498db','#2ecc71','#f1c40f']
            }]
        },
        options: {
            responsive: true, //è‡ªå‹•èª¿ç¯€åœ–è¡¨å¤§å°
            maintainAspectRatio: false,//ä¿æŒé•·å¯¬æ¯”
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                stepSize: 1,      
                precision: 0,     // ç¢ºä¿é¡¯ç¤ºç‚ºæ•´æ•¸ã€‚å°æ•¸é»ç‚º0
                    }
                }
            }
        }
    });

    
</script>

</body>
</html>
